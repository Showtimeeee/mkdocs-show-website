# Гайд по Charles: Основы и Практическое Применение

---
 ![Мой аватар](images/charle.png)


## **Введение в Charles**

Charles — это мощный прокси-сервер для HTTP и HTTPS, который позволяет отслеживать, анализировать и модифицировать сетевой трафик между вашим устройством (например, компьютером или смартфоном) и серверами. Этот инструмент особенно полезен для разработчиков, тестировщиков и аналитиков, которые хотят понять, как работает их приложение, выявить ошибки или протестировать API.

Charles помогает:
- Анализировать запросы и ответы.
- Дебажить проблемы с API.
- Модифицировать трафик в режиме реального времени.
- Проверять SSL-трафик (HTTPS).
- Эмулировать медленные соединения.

---

## **1. Установка Charles**

**Шаг 1: Скачивание**
Перейдите на официальный сайт Charles: [https://www.charlesproxy.com/](https://www.charlesproxy.com/) и скачайте версию для вашей операционной системы:
- Windows
- macOS
- Linux

**Шаг 2: Установка**
Установите Charles, следуя инструкциям установщика. После установки запустите приложение.

**Шаг 3: Настройка лицензии**
Charles работает в пробном режиме (30 минут работы, после чего требуется перезапуск). Для полноценного использования купите лицензию или активируйте пробную версию.

---

## **2. Основные функции Charles**

### **2.1. Отслеживание трафика**
После запуска Charles автоматически начинает записывать весь HTTP/HTTPS трафик с вашего устройства. Вы можете увидеть список запросов в главном окне.

### **2.2. Фильтрация трафика**
Чтобы фильтровать трафик по доменам:
1. Перейдите в меню **Structure** или **Sequence**.
2. Используйте строку поиска для быстрого поиска нужных запросов.
3. Включите фильтр по домену через **Proxy > Recording Settings > Include/Exclude**.

### **2.3. Анализ запросов и ответов**
Кликните на любой запрос, чтобы увидеть подробности:
- **Overview:** Общая информация о запросе.
- **Headers:** Заголовки запроса и ответа.
- **Body:** Тело запроса и ответа (JSON, XML, HTML и др.).

---

## **3. Настройка HTTPS-мониторинга**

Для анализа HTTPS-трафика необходимо настроить SSL-проксирование:

### **Шаг 1: Включение SSL Proxying**
1. Перейдите в **Proxy > SSL Proxying Settings**.
2. Включите опцию **Enable SSL Proxying**.
3. Добавьте домены, которые нужно мониторить (например, `*.example.com`).

### **Шаг 2: Установка сертификата Charles**
1. На вашем устройстве откройте браузер и перейдите по адресу `chls.pro/ssl`.
2. Скачайте и установите сертификат Charles.
   - **macOS:** Двойным кликом добавьте сертификат в "Ключи доступа".
   - **Windows:** Установите сертификат через "Управление сертификатами".
   - **iOS/Android:** Следуйте инструкциям на экране для установки сертификата.

### **Шаг 3: Проверка**
После установки сертификата HTTPS-трафик будет отображаться в Charles.

---

## **4. Модификация трафика**

Charles позволяет изменять запросы и ответы в реальном времени.

### **4.1. Создание Breakpoints**
1. Найдите запрос, который хотите модифицировать.
2. Щелкните правой кнопкой мыши и выберите **Breakpoints**.
3. Когда запрос будет отправлен, Charles остановит его перед отправкой или получением ответа.
4. Внесите изменения в тело запроса или ответа и нажмите **Execute**.

### **4.2. Map Local**
Используйте эту функцию для подмены ответов сервера локальными файлами:
1. Перейдите в **Tools > Map Local**.
2. Добавьте правило, указав URL и путь к локальному файлу.

### **4.3. Rewrite**
Эта функция позволяет автоматически изменять запросы и ответы:
1. Перейдите в **Tools > Rewrite**.
2. Создайте новое правило и укажите условия для изменения.

---

## **5. Эмуляция медленных соединений**

Чтобы протестировать приложение в условиях медленного интернета:
1. Перейдите в **Proxy > Throttle Settings**.
2. Включите **Enable Throttling**.
3. Выберите предустановленный профиль (например, 3G, DSL) или создайте собственный.

---

## **6. Подключение мобильных устройств**

Чтобы отслеживать трафик с мобильного устройства:
1. Убедитесь, что ваш компьютер и устройство находятся в одной сети Wi-Fi.
2. Найдите IP-адрес вашего компьютера (в Charles: **Help > Local IP Address**).
3. Настройте прокси на устройстве:
   - **iOS/Android:** В настройках Wi-Fi укажите IP-адрес компьютера и порт 8888.
4. Установите сертификат Charles на устройстве (аналогично пункту 3.2).

---

## **7. Советы по использованию**

- **Очистка данных:** Используйте **Clear Current Session**, чтобы очистить текущую сессию.
- **Экспорт данных:** Сохраняйте сессии в формате `.chls` для последующего анализа.
- **Работа с большими файлами:** Если трафик слишком объемный, используйте фильтры или сохраняйте только нужные данные.
- **Автоматизация:** Используйте скрипты для автоматизации повторяющихся задач.

---

## **Заключение**

Charles — это универсальный инструмент для анализа и отладки сетевого трафика. Он поможет вам лучше понять работу вашего приложения, выявить проблемы и улучшить качество разработки. Начните с базовых функций, таких как мониторинг трафика и работа с HTTPS, а затем переходите к более сложным возможностям, таким как модификация запросов и эмуляция медленных соединений.
