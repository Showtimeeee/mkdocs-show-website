# –ì–∞–π–¥ –ø–æ –Ø–Ω–¥–µ–∫—Å –¢–∞–Ω–∫  

–≠—Ç–æ –º–æ—â–Ω—ã–π open-source –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è **–Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è** –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –∏ API. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä —Å —Ü–µ–ª—å—é –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –∏ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–∫–ª–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã.

---

## –ó–∞—á–µ–º –Ω—É–∂–µ–Ω –Ø–Ω–¥–µ–∫—Å –¢–∞–Ω–∫?

- –ß—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, **–∫–∞–∫ —Å–∏—Å—Ç–µ–º–∞ –≤–µ–¥—ë—Ç —Å–µ–±—è –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π**
- –ß—Ç–æ–±—ã –Ω–∞–π—Ç–∏ ¬´—É–∑–∫–∏–µ –º–µ—Å—Ç–∞¬ª –∏ —Ç–æ—á–∫–∏ –æ—Ç–∫–∞–∑–∞
- –ß—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Å–∞–π—Ç –Ω–µ —É–ø–∞–¥—ë—Ç –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω—É—é –∞–Ω–∞–ª–∏—Ç–∏–∫—É: –≥—Ä–∞—Ñ–∏–∫–∏, –º–µ—Ç—Ä–∏–∫–∏, –ª–æ–≥–∏

---

## üß† –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–Ω—è—Ç–∏—è

| –ü–æ–Ω—è—Ç–∏–µ              | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------------------|----------|
| **–ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã –ø—Ä–∏ –≤—ã—Å–æ–∫–∏—Ö –Ω–∞–≥—Ä—É–∑–∫–∞—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, 1000 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤) |
| **–°—Ü–µ–Ω–∞—Ä–∏–π –Ω–∞–≥—Ä—É–∑–∫–∏** | –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è |
| **–õ–∏–Ω–µ–π–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞** | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º |
| **–°—Ç—É–ø–µ–Ω—å–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏** | –ù–∞–≥—Ä—É–∑–∫–∞ —Ä–∞—Å—Ç—ë—Ç —Å–∫–∞—á–∫–∞–º–∏ —á–µ—Ä–µ–∑ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ –ø—Ä–æ–º–µ–∂—É—Ç–∫–∏ –≤—Ä–µ–º–µ–Ω–∏ |
| **RPS (Requests per Second)** | –°–∫–æ—Ä–æ—Å—Ç—å –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É |
| **–ê–º–ø–ª–∏—Ç—É–¥–∞** | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –∏–ª–∏ RPS |

---

## üõ†Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ø–Ω–¥–µ–∫—Å –¢–∞–Ω–∫–∞

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —á–µ—Ä–µ–∑ pip (Linux / macOS)

```bash
pip3 install yandextank
```

### 2. –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–±: Docker

```bash
docker pull yc/ymilove:latest
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞

–¢–µ—Å—Ç—ã –≤ –Ø–Ω–¥–µ–∫—Å –¢–∞–Ω–∫–µ –æ–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ —Ñ–∞–π–ª–µ `load.yaml` (–∏–ª–∏ –ª—é–±–æ–º –¥—Ä—É–≥–æ–º `.yaml`).

–ü—Ä–∏–º–µ—Ä –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ñ–∏–≥–∞:

```yaml
phantom:
  address: example.com    # –∞–¥—Ä–µ—Å —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ–≥–æ —Å–∞–π—Ç–∞
  port: 80                # –ø–æ—Ä—Ç
  ssl: false              # –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SSL
  load_profile:
    load_type: rps        # —Ç–∏–ø –Ω–∞–≥—Ä—É–∑–∫–∏: RPS
    schedule: line(1, 10, 10m)  # –≥—Ä–∞—Ñ–∏–∫ –Ω–∞–≥—Ä—É–∑–∫–∏
ammo_file: ammo.txt      # —Ñ–∞–π–ª —Å —Å—Ü–µ–Ω–∞—Ä–∏—è–º–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
```

---

## üìù –§–∞–π–ª —Å –±–æ–µ–≤—ã–º–∏ –∑–∞—Ä—è–¥–∞–º–∏ (`ammo.txt`)

–≠—Ç–æ —Å–ø–∏—Å–æ–∫ HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è.

–ü—Ä–∏–º–µ—Ä —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ `ammo.txt`:

```
GET / HTTP/1.1
Host: example.com
Connection: close

GET /about HTTP/1.1
Host: example.com
Connection: close
```

---

## ‚öôÔ∏è –ü—Ä–∏–º–µ—Ä—ã –≥—Ä–∞—Ñ–∏–∫–æ–≤ –Ω–∞–≥—Ä—É–∑–∫–∏ (schedule)

| –¢–∏–ø –Ω–∞–≥—Ä—É–∑–∫–∏       | –ü—Ä–∏–º–µ—Ä –∑–∞–ø–∏—Å–∏         | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------------------|------------------------|----------|
| –õ–∏–Ω–µ–π–Ω–∞—è           | `line(1, 10, 10m)`     | –û—Ç 1 –¥–æ 10 RPS –∑–∞ 10 –º–∏–Ω—É—Ç |
| –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∞          | `const(50, 5m)`        | 50 RPS –≤ —Ç–µ—á–µ–Ω–∏–µ 5 –º–∏–Ω—É—Ç |
| –°—Ç—É–ø–µ–Ω—å–∫–∞          | `step(10, 100, 10, 1m)`| –ù–∞–≥—Ä—É–∑–∫–∞ —Ä–∞—Å—Ç—ë—Ç –ø–æ 10 RPS –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É –¥–æ 100 |
| –†–∞–≤–Ω–æ–º–µ—Ä–Ω–∞—è        | `flat(30, 5m)`         | 30 RPS –≤ —Ç–µ—á–µ–Ω–∏–µ 5 –º–∏–Ω—É—Ç |

---

## üìä –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç

```bash
yandex-tank load.yaml
```

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –≤—ã —É–≤–∏–¥–∏—Ç–µ:
- –î–∏–Ω–∞–º–∏–∫—É –Ω–∞–≥—Ä—É–∑–∫–∏
- –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞
- –ß–∏—Å–ª–æ –æ—à–∏–±–æ–∫
- –ò –¥—Ä—É–≥–∏–µ –ø–æ–ª–µ–∑–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏

---

## üìà –û—Ç—á—ë—Ç –∏ –∞–Ω–∞–ª–∏–∑

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç–µ—Å—Ç–∞ –Ø–Ω–¥–µ–∫—Å –¢–∞–Ω–∫ —Å–æ–∑–¥–∞—ë—Ç HTML-–æ—Ç—á—ë—Ç. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –æ–Ω –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É:

```
file:///tmp/yandex-tank/report/report.html
```

–í –æ—Ç—á—ë—Ç–µ –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å:
- –ì—Ä–∞—Ñ–∏–∫ RPS
- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–≤–µ—Ç–∞
- –ß–∏—Å–ª–æ –æ—à–∏–±–æ–∫
- –î–∏–∞–≥—Ä–∞–º–º—ã –Ω–∞–≥—Ä—É–∑–∫–∏

---

## üì¶ –ü–æ–ª–µ–∑–Ω—ã–µ –ø–ª–∞–≥–∏–Ω—ã –Ø–Ω–¥–µ–∫—Å –¢–∞–Ω–∫–∞

| –ü–ª–∞–≥–∏–Ω             | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------------------|----------|
| **Autostop**       | –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ç–µ—Å—Ç –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –ø–æ—Ä–æ–≥–∞ –æ—à–∏–±–æ–∫ –∏–ª–∏ –∑–∞–¥–µ—Ä–∂–µ–∫ |
| **Console Online** | –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å —Ç–µ—Å—Ç–∞ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ |
| **JMeter**         | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ JMeter-—Å–∫—Ä–∏–ø—Ç–æ–≤ |
| **Uploader**       | –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –≤–Ω–µ—à–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –∞–Ω–∞–ª–∏–∑–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Grafana –∏–ª–∏ Charles Proxy) |

---

## üß™ –ü—Ä–∏–º–µ—Ä –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–≥–æ –∫–æ–Ω—Ñ–∏–≥–∞

```yaml
phantom:
  address: test-api.local
  port: 8080
  ssl: false
  load_profile:
    load_type: rps
    schedule: step(10, 100, 10, 2m)
ammo_file: requests.txt

autostop:
  errors(rel): 10%   # –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–µ—Å—Ç, –µ—Å–ª–∏ –±–æ–ª–µ–µ 10% –æ—à–∏–±–æ–∫

console:
  enabled: true
```

---

## üß† –°–æ–≤–µ—Ç—ã –ø–æ –Ω–∞—á–∞–ª—É —Ä–∞–±–æ—Ç—ã

1. –ù–∞—á–Ω–∏ —Å –ø—Ä–æ—Å—Ç—ã—Ö —Ç–µ—Å—Ç–æ–≤: –æ–¥–∏–Ω URL, –∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞.
2. –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ —É—Å–ª–æ–∂–Ω—è–π –≥—Ä–∞—Ñ–∏–∫ –Ω–∞–≥—Ä—É–∑–∫–∏.
3. –ò—Å–ø–æ–ª—å–∑—É–π `console` –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.
4. –ù–µ –∑–∞–±—ã–≤–∞–π –ø—Ä–æ–≤–µ—Ä—è—Ç—å –æ—Ç—á—ë—Ç—ã –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —Ç–µ—Å—Ç–∞.
5. –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä—É–π —Å —Ä–∞–∑–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –Ω–∞–≥—Ä—É–∑–∫–∏ –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –ø–æ–≤–µ–¥–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã.